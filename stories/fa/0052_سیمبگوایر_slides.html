<!DOCTYPE html>
<head>
<meta charset="utf-8">
  <title>سیمبِگوایر  - Global African Storybook</title>
  <style type="text/css">code{white-space: pre;}</style>
<style>
  html { background-color: black; }
  body { background-color: white; border-radius: 12px}
  /* A section is a slide. It's size is 800x600, and this will never change */
  section {
      font-family: Arial, serif;
      font-size: 14pt;
      text-align: center;
    }
  address, blockquote, dl, fieldset, form, h1, h2, h3, h4, h5, h6, hr, ol, p, pre, table, ul, dl { padding: 10px 20px 10px 20px; }
  h1, h2, h3 {
    text-align: center;
    margin: 10pt 10pt 20pt 10pt;
  }
  ul, ol {
    margin: 10px 10px 10px 50px;
  }
  img {
    width: 40%;
  }
  .license {
    font-size: small;
  }
  .license img {
    width: auto;
  }
  section.titleslide h1 { margin-top: 200px; }
  h1.title { margin-top: 150px; }
  h1 { font-size: 180%; }
  h2 { font-size: 120%; }
  h3 { font-size: 100%; }
  q { quotes: "“" "”" "‘" "’"; }
  blockquote { font-style: italic }
  /* Figures are displayed full-page, with the caption on
     top of the image/video */
  figure {
    background-color: black;
  }
  figcaption {
    margin: 70px;
  }
  footer {
    position: absolute;
    bottom: 0;
    width: 100%;
    padding: 40px;
    text-align: right;
    background-color: #F3F4F8;
    border-top: 1px solid #CCC;
  }

  /* Transition effect */
  /* Feel free to change the transition effect for original
     animations. See here:
     https://developer.mozilla.org/en/CSS/CSS_transitions
     How to use CSS3 Transitions: */
  section {
      -moz-transition: left 400ms linear 0s;
      -webkit-transition: left 400ms linear 0s;
      -ms-transition: left 400ms linear 0s;
      transition: left 400ms linear 0s;
  }

  /* Before */
  section { left: -150%; }
  /* Now */
  section[aria-selected] { left: 0; }
  /* After */
  section[aria-selected] ~ section { left: +150%; }

  /* Incremental elements */

  /* By default, visible */
  .incremental > * { opacity: 1; }

  /* The current item */
  .incremental > *[aria-selected] { color: red; opacity: 1; }

  /* The items to-be-selected */
  .incremental > *[aria-selected] ~ * { opacity: 0.2; }
</style>
</head>
<body>

<section id="سیمبگوایر" class="slide level1">
<h1 dir="rtl">سیمبِگوایر</h1>
<center>
<img src="https://raw.githubusercontent.com/global-asp/asp-imagebank/master/medium/0052/01.jpg" />
</center>

</section>
<section class="slide level1">

<p dir="rtl"><img src="https://raw.githubusercontent.com/global-asp/asp-imagebank/master/medium/0052/02.jpg" /></p>
<p dir="rtl">وَقتی کِه مادَرِسیمبِگوایر مُرد، او خِیلی غَمگین بود. پِدَرِ سیمبِگوایر تمام تلاشش را کرد تا اَز دُختَرَش مُراقِبَت کُنَد. کَم کَم آنها یاد گِرِفتَند کِه بِدونِ وُجودِ مادَرِسیمبِگوایر دوبارِه اِحساسِ شادی کُنَند. هَر روز صُبح آنها مینشَستَند وَ دَر مورِدِ روزی کِه پیشِ رو داشتَند با هَم صُحبَت میکَردَند. هَر بَعد اَز ظُهر با هَم شام دُرُست میکَردَند. بَعد اَز شُستَنِ ظَرفها، پِدَرِسیمبِگوایر دَر اَنجامِ تَکالیفَش بِه او کُمَک میکَرد.</p>
<center>
<strong>1</strong>
</center>

</section>
<section class="slide level1">

<p dir="rtl"><img src="https://raw.githubusercontent.com/global-asp/asp-imagebank/master/medium/0052/03.jpg" /></p>
<p dir="rtl">یِک روز پِدَرِ سیمبِگوایر دیرتَر اَز هَمیشه بِه خانِه آمَد. او صِدا زَد، &quot;دُختَرَم کُجایی؟&quot; سیمبِگوایر بِه سَمتِ پِدَرَش دَوید. اوبیحَرِکَت ایستاد وَقتی کِه دید پَدَرَش دَستِ زَنی را گِرِفتِه بود.&quot; دُختَرَم، مَن میخواهَم کِه تو شَخصِ خاصی را ملاقات کُنی. با لَبخَند گُفت، &quot;این آنیتا هَست&quot;.</p>
<center>
<strong>2</strong>
</center>

</section>
<section class="slide level1">

<p dir="rtl"><img src="https://raw.githubusercontent.com/global-asp/asp-imagebank/master/medium/0052/04.jpg" /></p>
آنیتا گُفت، &quot;سَلام سیمبِگوایر ، پَدَرَت دَر مورِدِ تو زیاد بَرایَم گُفتِه اَست. &quot; وَلی او لَبخَند نَزَد یا دَستِ سیمبِگوایر را نَگِرِفت. پِدَرِ سیمبِگوایر خوشحال وَ هَیَجان زَدِه بود. او دَر مُورِد اینکه اَگَرهَر سِه تایِ آنها با هَم زِندگی کنُنَد، چِقَدر خُوشبَخت میشَوَند صُحبَت کَرد. او گُفت &quot;دُختَرَم، مَن اُمیدوارَم کِه تو آنیتا را بِه عُنوانِ مادَرَت بِپَذیری . &quot;
<center>
<strong>3</strong>
</center>

</section>
<section class="slide level1">

<p dir="rtl"><img src="https://raw.githubusercontent.com/global-asp/asp-imagebank/master/medium/0052/05.jpg" /></p>
<p dir="rtl">زِندگی سیمبِگوایر تَغییر کَرد. او دیگر وَقت نَداشت کِه صُبح کِنارِ پِدَرَش بنشیند. آنیتا کارهایِ خانِه یِ خِیلی زیادی بِه او میداد دَر حَدی کِه بَعد اَزظُهرها بَرایِ اَنجامِ تَکالیفَش خِیلی خَستِه بود. او بَعد اَزخوردَنِ شام یِک راست بِه رَختِخواب میرفت. تَنها چیزی کِه بِه او آرامِش میداد پَتویِ رَنگارَنگی بود کِه مادَرَش بِه او دادِه بود. پِدَرِسیمبِگوایر مُتِوَجِه نَبود کِه دُختَرَش شاد بِه نَظَر نِمیرسد.</p>
<center>
<strong>4</strong>
</center>

</section>
<section class="slide level1">

<p dir="rtl"><img src="https://raw.githubusercontent.com/global-asp/asp-imagebank/master/medium/0052/06.jpg" /></p>
<p dir="rtl">بَعد اَز چَند ماه، پِدَرِسیمبِگوایر بِه آنها گُفت کِه باید بَرایِ مُدتی خانِه را تَرک کُنَد. او گُفت، &quot;باید بِه سَفَری کاری بِرَوَم.&quot; &quot;وَلی میدانَم کِه شُما مُراقِبِ هَم خواهید بود.&quot; صورَتِ سیمبِگوایر آویزان وَ غَمگین شُد، وَلی پِدَرَش مُتِوَجِه نَشُد. آنیتا هیچ حَرفی نَزَد. او هَم خوشحال نَبود.</p>
<center>
<strong>5</strong>
</center>

</section>
<section class="slide level1">

<p dir="rtl"><img src="https://raw.githubusercontent.com/global-asp/asp-imagebank/master/medium/0052/07.jpg" /></p>
<p dir="rtl">اوضاع بَرایِ سیمبِگوایر بَدتَر شُد. اَگَر اوکارهایِ روزمَرِه را تَمام نِمی کَرد یا شِکایَت میکَرد، آنیتا او را کُتَک میزَد. وَ موقِع شام، آنیتا بیشتَرغَذا ها را میخورد، وَ سیمبِگوایر را با اَندَکی غَذا رَها میکَرد. هَر شَب سیمبِگوایر برایِ خودَش گِریه میکَرد وَ پَتویِ مادَرَش را دَر آغوش میگِرِفت تا خوابَش بِبَرَد.</p>
<center>
<strong>6</strong>
</center>

</section>
<section class="slide level1">

<p dir="rtl"><img src="https://raw.githubusercontent.com/global-asp/asp-imagebank/master/medium/0052/08.jpg" /></p>
<p dir="rtl">یِک روز صُبح، سیمبِگوایر دیر اَز رَختِخواب بُلَند شُد. آنیتا سَرَش داد زِد وَ گُفت، &quot;تو دُختَرِ تَنبَلی هَستی!&quot; او سیمبِگوایر را اَز تَخت هُل داد. آن پَتویِ با اَرزِش بِه ناخُنش گیر کَرد وَ به دو قِسمَت پارِه شُد.</p>
<center>
<strong>7</strong>
</center>

</section>
<section class="slide level1">

<p dir="rtl"><img src="https://raw.githubusercontent.com/global-asp/asp-imagebank/master/medium/0052/09.jpg" /></p>
<p dir="rtl">سیمبِگوایر خِیلی آشُفتِه بود. او تَصمیم گِرِفت کِه اَز خانِه فَرار کُنَد. او قِسمَتی اَز پَتویِ مادَرَش را بَرداشت، مِقداری غَذا بَرداشت وَ خانه را تَرک کَرد. او راهی کِه پِدَرَش رَفته بود را دُنبال کَرد.</p>
<center>
<strong>8</strong>
</center>

</section>
<section class="slide level1">

<p dir="rtl"><img src="https://raw.githubusercontent.com/global-asp/asp-imagebank/master/medium/0052/10.jpg" /></p>
<p dir="rtl">وَقتی که غُروب شُد، اَز یِک دِرَختِ بُلَند نَزدیکِ رود بالا رَفت وَ دَرشاخِه ها بَرایِ خودَش تَختی دُرُست کَرد. تا زَمانی که به خواب رَفت آواز میخوانَد: &quot;مامان، مامان، مامان تو مَن را رَها کَردی. تو مَرا رَها کَردی وَ دیگر هیچوَقت بَرنَگَشتی. پِدَردیگر مَن را دوست نَدارَد. مامان، تو کِی بَرمیگَردی؟ تو مَنو رَها کَردی.&quot;</p>
<center>
<strong>9</strong>
</center>

</section>
<section class="slide level1">

<p dir="rtl"><img src="https://raw.githubusercontent.com/global-asp/asp-imagebank/master/medium/0052/11.jpg" /></p>
<p dir="rtl">صُبحِ روزِ بَعد، سیمبِگوایر دوباره آواز خواند. وَقتی که زَنان بَرایِ شُستَنِ لِباس هایِشان به کِنارِ رود آمَدَند، صِدایِ آوازِ غَمگینی را کِه اَز بالایِ یِک دِرَختِ بُلَند میامَد، شنیدند. آنها فِکر کَردَند کِه آن فَقَط باد اَست کِه بَرگ ها را بِه صِدا دَر میاوَرَد، وَبه کارِ خود اِدامِه دادَند. وَلی یِکی اَز خانُم ها خِیلی با دِقَت بِه آواز گوش داد.</p>
<center>
<strong>10</strong>
</center>

</section>
<section class="slide level1">

<p dir="rtl"><img src="https://raw.githubusercontent.com/global-asp/asp-imagebank/master/medium/0052/12.jpg" /></p>
<p dir="rtl">آن زَن بِه بالایِ دِرَخت نِگاه کَرد. وَقتی کِه او آن دِختَر وَ قِسمَتی اَز پَتویِ رَنگارَنگَش را دید، گِریه کَرد، &quot;سیمبِگوایر ، دُختَرِ بَرادَرَم.&quot; زَنانِ دیگَر شُستشو را مُتِوَقِف کَرد وَ بِه سیمبِگوایر دَر پایین آمَدَن اَز دِرَخت کُمَک کَرد. عَمِه اَش آن دُختَرَک را دَر آغوش گِرِفت وَسَعی کَرد اورا دِلداری دَهَد.</p>
<center>
<strong>11</strong>
</center>

</section>
<section class="slide level1">

<p dir="rtl"><img src="https://raw.githubusercontent.com/global-asp/asp-imagebank/master/medium/0052/13.jpg" /></p>
<p dir="rtl">عَمِه یِ سیمبِگوایر او را بِه خانِه یِ خودَش بُرد. او بِه سیمبِگوایر غَذایِ گَرم داد، وَ او را با پَتویِ مادَرَش دَر رَختِخواب گُذاشت. آن شَب سیمبِگوایر گِریه کَرد تا زَمانی کِه خوابَش بُرد. وَلی آنها اَشکِ آسودِگی بود. او میدانِست کِه عَمِه اَش مُراقِبَش خواهَد بود.</p>
<center>
<strong>12</strong>
</center>

</section>
<section class="slide level1">

<p dir="rtl"><img src="https://raw.githubusercontent.com/global-asp/asp-imagebank/master/medium/0052/14.jpg" /></p>
<p dir="rtl">وَقتی کِه پِدَرِسیمبِگوایر بِه خانِه بَرگَشت، اُتاقَش را خالی دید. با قلبی اندوهگین پُرسید، &quot;چِه اِتِفاقی اُفتادِه آنیتا؟&quot; زن توضیح داد کِه سیمبِگوایر فَرار کَردِه اَست. او گُفت، &quot;مَن اَز او خواستَم کِه بِه مَن اِحتِرام بِگُذارَد،&quot;وَلی شاید مَن خِیلی سَخت گیر بودَم.&quot; پِدَرِ سیمبِگوایر خانِه را تَرک کَرد وَ بِه سَمتِ مَسیر رود رَفت. او مَسیرش را بِه سَمتَ روستایِ خواهَرَش اِدامِه داد تا بِبیند کِه آیا او سیمبِگوایر را دیده است.</p>
<center>
<strong>13</strong>
</center>

</section>
<section class="slide level1">

<p dir="rtl"><img src="https://raw.githubusercontent.com/global-asp/asp-imagebank/master/medium/0052/15.jpg" /></p>
<p dir="rtl">سیمبِگوایر داشت با بَچِه هایِ عَمِه اَش بازی میکَرد کِه پِدَرَش را اَز دور دید. او تَرسیده بود مُمکِن بود پِدَرَش عَصَبانی باشَد، پَس او بِه داخِلِ خانِه دَوید تا قایِم شَوَد. وَلی پِدَرَش بِه سَمتِ او رَفت وَ گُفت، &quot;سیمبِگوایر ، تو یِک مادَرِ عالی بَرایِ خودَت پِیدا کَردی. کَسی کِه تو را دوست دارَد وَتو را میفَهمَد. مَن بِه تو اِفتِخار میکُنَم وَ تو را دوست دارَم.&quot; آنها مُوافِقَت کَردَند کِه سیمبِگوایر تا زَمانی کِه بِخواهَد پیشِ عَمِه اَش بِمانَد.</p>
<center>
<strong>14</strong>
</center>

</section>
<section class="slide level1">

<p dir="rtl"><img src="https://raw.githubusercontent.com/global-asp/asp-imagebank/master/medium/0052/16.jpg" /></p>
<p dir="rtl">پِدَرَش هَر روز بِه دیدنِ او می رَفت. سَراَنجام او با آنیتا رَفت. او دَستَش را دِراز کَرد کَه دَستانِ سیمبِگوایر را بِگیرد. او گِریه کَرد وَگُفت، &quot;مَن خِیلی مُتِاَسِفَم کوچولو، مَن اِشتِباه کَردَم.&quot; &quot;بِه مَن اِجازِه می دَهی کِه دُوبارِه اِمتِحان کُنَم؟&quot; سیمبِگوایر بِه پِدَرَش وَصورَتِ نِگَرانَش نِگاه کَرد. سِپَس بِه آرامی بِه سَمتِ آنیتا قَدَم بَرداشت وَ دَستانَش را دورِ او حَلقِه کَرد.</p>
<center>
<strong>15</strong>
</center>

</section>
<section class="slide level1">

<p dir="rtl"><img src="https://raw.githubusercontent.com/global-asp/asp-imagebank/master/medium/0052/17.jpg" /></p>
<p dir="rtl">هَفتِه یِ بَعد، آنیتا، سیمبِگوایر ،عَمِه وَ پِسَر عَمِه هایَش را بِه صَرفِ عَصرانِه بِه خانِه دَعوَت کَرد. عَجَب ضیافَتی! آنیتا تَمامِ غَذاهایِ مورِدِ عَلاقِه یِ سیمبِگوایر را آمادِه کَردِه بود، وَهَمِگی تا جایی کِه جا داشتَند اَز آنها خوردَند. سِپَس بَچِه ها دَر حالیکِه بُزُرگتَرها مَشغولِ صُحبَت بودَند سَرگَرمِ بازی شُدَند. سیمبِگوایر اِحساسِ شادی وَ شُجاعَت کَرد. او زود تَصمیم گِرِفت، خِیلی زود، کِه بِه خانِه بَرگَردَد وَبا پِدَر وَ نامادَریَش زِندگی کُنَد.</p>
<center>
<strong>16</strong>
</center>

</section>
<section class="slide level1">

<h2 dir="rtl" id="سیمبگوایر-1">سیمبِگوایر</h2>
<strong>Text:</strong> Rukia Nantale<br> <strong>Illustrations:</strong> Benjamin Mitchley<br> <strong>Translation:</strong> Marzieh Mohammadian Haghighi<br> <strong>Language:</strong> Persian<br>
<p dir="rtl">
This story is brought to you by the <a href='https://global-asp.github.io/'>Global African Storybook Project</a>, an effort to translate the stories of the <a href='http://africanstorybook.org/'>African Storybook Project</a> into all the languages of the world.
<p dir="rtl">
You can view the original story on the ASP website <a href='http://africanstorybook.org/stories/simbegwire'>here</a>
<p dir="rtl"><div class="license">
<a href="https://global-asp.github.io"><img src="https://global-asp.github.io/logo.png" alt="Global ASP logo" border="0" /></a>
</div>

<p dir="rtl"><center><div class="license">
<a rel="license" href="http://creativecommons.org/licenses/by/3.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/3.0/88x31.png" /></a><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/3.0/">Creative Commons Attribution 3.0 Unported License</a>.
</div></center>


</section>


<!-- {{{{ dzslides core
#
#
#     __  __  __       .  __   ___  __
#    |  \  / /__` |    | |  \ |__  /__`
#    |__/ /_ .__/ |___ | |__/ |___ .__/ core :€
#
#
# The following block of code is not supposed to be edited.
# But if you want to change the behavior of these slides,
# feel free to hack it!
#
-->

<div id="progress-bar"></div>

<!-- Default Style -->
<style>
  * { margin: 0; padding: 0; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; box-sizing: border-box; }
  details { display: none; }
  body {
    width: 800px; height: 600px;
    margin-left: -400px; margin-top: -300px;
    position: absolute; top: 50%; left: 50%;
    overflow: hidden;
  }
  section {
    position: absolute;
    pointer-events: none;
    width: 100%; height: 100%;
  }
  section[aria-selected] { pointer-events: auto; }
  html { overflow: hidden; }
  body { display: none; }
  body.loaded { display: block; }
  .incremental {visibility: hidden; }
  .incremental[active] {visibility: visible; }
  #progress-bar{
    bottom: 0;
    position: absolute;
    -moz-transition: width 400ms linear 0s;
    -webkit-transition: width 400ms linear 0s;
    -ms-transition: width 400ms linear 0s;
    transition: width 400ms linear 0s;
  }
  figure {
    width: 100%;
    height: 100%;
  }
  figure > * {
    position: absolute;
  }
  figure > img, figure > video {
    width: 100%; height: 100%;
  }
</style>

<script>
  var Dz = {
    remoteWindows: [],
    idx: -1,
    step: 0,
    slides: null,
    progressBar : null,
    params: {
      autoplay: "1"
    }
  };

  Dz.init = function() {
    document.body.className = "loaded";
    this.slides = $$("body > section");
    this.progressBar = $("#progress-bar");
    this.setupParams();
    this.onhashchange();
    this.setupTouchEvents();
    this.onresize();
  }
  
  Dz.setupParams = function() {
    var p = window.location.search.substr(1).split('&');
    p.forEach(function(e, i, a) {
      var keyVal = e.split('=');
      Dz.params[keyVal[0]] = decodeURIComponent(keyVal[1]);
    });
  // Specific params handling
    if (!+this.params.autoplay)
      $$.forEach($$("video"), function(v){ v.controls = true });
  }

  Dz.onkeydown = function(aEvent) {
    // Don't intercept keyboard shortcuts
    if (aEvent.altKey
      || aEvent.ctrlKey
      || aEvent.metaKey
      || aEvent.shiftKey) {
      return;
    }
    if ( aEvent.keyCode == 37 // left arrow
      || aEvent.keyCode == 38 // up arrow
      || aEvent.keyCode == 33 // page up
    ) {
      aEvent.preventDefault();
      this.back();
    }
    if ( aEvent.keyCode == 39 // right arrow
      || aEvent.keyCode == 40 // down arrow
      || aEvent.keyCode == 34 // page down
    ) {
      aEvent.preventDefault();
      this.forward();
    }
    if (aEvent.keyCode == 35) { // end
      aEvent.preventDefault();
      this.goEnd();
    }
    if (aEvent.keyCode == 36) { // home
      aEvent.preventDefault();
      this.goStart();
    }
    if (aEvent.keyCode == 32) { // space
      aEvent.preventDefault();
      this.toggleContent();
    }
    if (aEvent.keyCode == 70) { // f
      aEvent.preventDefault();
      this.goFullscreen();
    }
  }

  /* Touch Events */

  Dz.setupTouchEvents = function() {
    var orgX, newX;
    var tracking = false;

    var db = document.body;
    db.addEventListener("touchstart", start.bind(this), false);
    db.addEventListener("touchmove", move.bind(this), false);

    function start(aEvent) {
      aEvent.preventDefault();
      tracking = true;
      orgX = aEvent.changedTouches[0].pageX;
    }

    function move(aEvent) {
      if (!tracking) return;
      newX = aEvent.changedTouches[0].pageX;
      if (orgX - newX > 100) {
        tracking = false;
        this.forward();
      } else {
        if (orgX - newX < -100) {
          tracking = false;
          this.back();
        }
      }
    }
  }

  /* Adapt the size of the slides to the window */

  Dz.onresize = function() {
    var db = document.body;
    var sx = db.clientWidth / window.innerWidth;
    var sy = db.clientHeight / window.innerHeight;
    var transform = "scale(" + (1/Math.max(sx, sy)) + ")";

    db.style.MozTransform = transform;
    db.style.WebkitTransform = transform;
    db.style.OTransform = transform;
    db.style.msTransform = transform;
    db.style.transform = transform;
  }


  Dz.getDetails = function(aIdx) {
    var s = $("section:nth-of-type(" + aIdx + ")");
    var d = s.$("details");
    return d ? d.innerHTML : "";
  }

  Dz.onmessage = function(aEvent) {
    var argv = aEvent.data.split(" "), argc = argv.length;
    argv.forEach(function(e, i, a) { a[i] = decodeURIComponent(e) });
    var win = aEvent.source;
    if (argv[0] === "REGISTER" && argc === 1) {
      this.remoteWindows.push(win);
      this.postMsg(win, "REGISTERED", document.title, this.slides.length);
      this.postMsg(win, "CURSOR", this.idx + "." + this.step);
      return;
    }
    if (argv[0] === "BACK" && argc === 1)
      this.back();
    if (argv[0] === "FORWARD" && argc === 1)
      this.forward();
    if (argv[0] === "START" && argc === 1)
      this.goStart();
    if (argv[0] === "END" && argc === 1)
      this.goEnd();
    if (argv[0] === "TOGGLE_CONTENT" && argc === 1)
      this.toggleContent();
    if (argv[0] === "SET_CURSOR" && argc === 2)
      window.location.hash = "#" + argv[1];
    if (argv[0] === "GET_CURSOR" && argc === 1)
      this.postMsg(win, "CURSOR", this.idx + "." + this.step);
    if (argv[0] === "GET_NOTES" && argc === 1)
      this.postMsg(win, "NOTES", this.getDetails(this.idx));
  }

  Dz.toggleContent = function() {
    // If a Video is present in this new slide, play it.
    // If a Video is present in the previous slide, stop it.
    var s = $("section[aria-selected]");
    if (s) {
      var video = s.$("video");
      if (video) {
        if (video.ended || video.paused) {
          video.play();
        } else {
          video.pause();
        }
      }
    }
  }

  Dz.setCursor = function(aIdx, aStep) {
    // If the user change the slide number in the URL bar, jump
    // to this slide.
    aStep = (aStep != 0 && typeof aStep !== "undefined") ? "." + aStep : ".0";
    window.location.hash = "#" + aIdx + aStep;
  }

  Dz.onhashchange = function() {
    var cursor = window.location.hash.split("#"),
        newidx = 1,
        newstep = 0;
    if (cursor.length == 2) {
      newidx = ~~cursor[1].split(".")[0];
      newstep = ~~cursor[1].split(".")[1];
      if (newstep > Dz.slides[newidx - 1].$$('.incremental > *').length) {
        newstep = 0;
        newidx++;
      }
    }
    this.setProgress(newidx, newstep);
    if (newidx != this.idx) {
      this.setSlide(newidx);
    }
    if (newstep != this.step) {
      this.setIncremental(newstep);
    }
    for (var i = 0; i < this.remoteWindows.length; i++) {
      this.postMsg(this.remoteWindows[i], "CURSOR", this.idx + "." + this.step);
    }
  }

  Dz.back = function() {
    if (this.idx == 1 && this.step == 0) {
      return;
    }
    if (this.step == 0) {
      this.setCursor(this.idx - 1,
                     this.slides[this.idx - 2].$$('.incremental > *').length);
    } else {
      this.setCursor(this.idx, this.step - 1);
    }
  }

  Dz.forward = function() {
    if (this.idx >= this.slides.length &&
        this.step >= this.slides[this.idx - 1].$$('.incremental > *').length) {
        return;
    }
    if (this.step >= this.slides[this.idx - 1].$$('.incremental > *').length) {
      this.setCursor(this.idx + 1, 0);
    } else {
      this.setCursor(this.idx, this.step + 1);
    }
  }

  Dz.goStart = function() {
    this.setCursor(1, 0);
  }

  Dz.goEnd = function() {
    var lastIdx = this.slides.length;
    var lastStep = this.slides[lastIdx - 1].$$('.incremental > *').length;
    this.setCursor(lastIdx, lastStep);
  }

  Dz.setSlide = function(aIdx) {
    this.idx = aIdx;
    var old = $("section[aria-selected]");
    var next = $("section:nth-of-type("+ this.idx +")");
    if (old) {
      old.removeAttribute("aria-selected");
      var video = old.$("video");
      if (video) {
        video.pause();
      }
    }
    if (next) {
      next.setAttribute("aria-selected", "true");
      var video = next.$("video");
      if (video && !!+this.params.autoplay) {
        video.play();
      }
    } else {
      // That should not happen
      this.idx = -1;
      // console.warn("Slide doesn't exist.");
    }
  }

  Dz.setIncremental = function(aStep) {
    this.step = aStep;
    var old = this.slides[this.idx - 1].$('.incremental > *[aria-selected]');
    if (old) {
      old.removeAttribute('aria-selected');
    }
    var incrementals = $$('.incremental');
    if (this.step <= 0) {
      $$.forEach(incrementals, function(aNode) {
        aNode.removeAttribute('active');
      });
      return;
    }
    var next = this.slides[this.idx - 1].$$('.incremental > *')[this.step - 1];
    if (next) {
      next.setAttribute('aria-selected', true);
      next.parentNode.setAttribute('active', true);
      var found = false;
      $$.forEach(incrementals, function(aNode) {
        if (aNode != next.parentNode)
          if (found)
            aNode.removeAttribute('active');
          else
            aNode.setAttribute('active', true);
        else
          found = true;
      });
    } else {
      setCursor(this.idx, 0);
    }
    return next;
  }

  Dz.goFullscreen = function() {
    var html = $('html'),
        requestFullscreen = html.requestFullscreen || html.requestFullScreen || html.mozRequestFullScreen || html.webkitRequestFullScreen;
    if (requestFullscreen) {
      requestFullscreen.apply(html);
    }
  }
  
  Dz.setProgress = function(aIdx, aStep) {
    var slide = $("section:nth-of-type("+ aIdx +")");
    if (!slide)
      return;
    var steps = slide.$$('.incremental > *').length + 1,
        slideSize = 100 / (this.slides.length - 1),
        stepSize = slideSize / steps;
    this.progressBar.style.width = ((aIdx - 1) * slideSize + aStep * stepSize) + '%';
  }
  
  Dz.postMsg = function(aWin, aMsg) { // [arg0, [arg1...]]
    aMsg = [aMsg];
    for (var i = 2; i < arguments.length; i++)
      aMsg.push(encodeURIComponent(arguments[i]));
    aWin.postMessage(aMsg.join(" "), "*");
  }
  
  function init() {
    Dz.init();
    window.onkeydown = Dz.onkeydown.bind(Dz);
    window.onresize = Dz.onresize.bind(Dz);
    window.onhashchange = Dz.onhashchange.bind(Dz);
    window.onmessage = Dz.onmessage.bind(Dz);
  }

  window.onload = init;
</script>


<script> // Helpers
  if (!Function.prototype.bind) {
    Function.prototype.bind = function (oThis) {

      // closest thing possible to the ECMAScript 5 internal IsCallable
      // function 
      if (typeof this !== "function")
      throw new TypeError(
        "Function.prototype.bind - what is trying to be fBound is not callable"
      );

      var aArgs = Array.prototype.slice.call(arguments, 1),
          fToBind = this,
          fNOP = function () {},
          fBound = function () {
            return fToBind.apply( this instanceof fNOP ? this : oThis || window,
                   aArgs.concat(Array.prototype.slice.call(arguments)));
          };

      fNOP.prototype = this.prototype;
      fBound.prototype = new fNOP();

      return fBound;
    };
  }

  var $ = (HTMLElement.prototype.$ = function(aQuery) {
    return this.querySelector(aQuery);
  }).bind(document);

  var $$ = (HTMLElement.prototype.$$ = function(aQuery) {
    return this.querySelectorAll(aQuery);
  }).bind(document);

  $$.forEach = function(nodeList, fun) {
    Array.prototype.forEach.call(nodeList, fun);
  }

</script>
<!-- vim: set fdm=marker: }}} -->
</body>
</html>
